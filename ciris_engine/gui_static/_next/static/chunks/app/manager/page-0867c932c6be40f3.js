(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2050],{702:(e,t,a)=>{Promise.resolve().then(a.bind(a,2860))},2710:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var s=a(4568);let n=a(7620).forwardRef((e,t)=>{let{className:a="",variant:n="default",size:r="default",...l}=e;return(0,s.jsx)("button",{ref:t,className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"," ").concat({default:"bg-blue-600 text-white hover:bg-blue-700",destructive:"bg-red-600 text-white hover:bg-red-700",outline:"border border-gray-300 bg-transparent hover:bg-gray-100",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300",ghost:"hover:bg-gray-100",link:"text-blue-600 underline-offset-4 hover:underline"}[n]," ").concat({default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}[r]," ").concat(a),...l})});n.displayName="Button"},2860:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>z});var s=a(4568),n=a(7620),r=a(9404);let l=n.createContext(void 0),i=e=>{let{children:t,defaultValue:a,className:r=""}=e,[i,c]=n.useState(a);return(0,s.jsx)(l.Provider,{value:{value:i,onValueChange:c},children:(0,s.jsx)("div",{className:r,children:t})})},c=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-600 ".concat(a),children:t})},o=e=>{let{value:t,children:a,className:r=""}=e,i=n.useContext(l);if(!i)throw Error("TabsTrigger must be used within Tabs");let c=i.value===t;return(0,s.jsx)("button",{type:"button",className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all ".concat(c?"bg-white text-gray-900 shadow-sm":"hover:bg-gray-200"," ").concat(r),onClick:()=>i.onValueChange(t),children:a})},d=e=>{let{value:t,children:a,className:r=""}=e,i=n.useContext(l);if(!i)throw Error("TabsContent must be used within Tabs");return i.value!==t?null:(0,s.jsx)("div",{className:"mt-2 ".concat(r),children:a})},u=e=>{let{children:t,variant:a="default",className:n=""}=e;return(0,s.jsx)("div",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors ".concat({default:"bg-blue-100 text-blue-800",secondary:"bg-gray-100 text-gray-800",destructive:"bg-red-100 text-red-800",outline:"border border-gray-300 text-gray-800"}[a]," ").concat(n),children:t})};var h=a(2710);let g=e=>{let{children:t,variant:a="default",className:n=""}=e;return(0,s.jsx)("div",{className:"relative w-full rounded-lg border p-4 ".concat({default:"bg-blue-50 text-blue-900 border-blue-200",destructive:"bg-red-50 text-red-900 border-red-200"}[a]," ").concat(n),children:t})},m=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"text-sm",children:t})};var x=a(9369),f=a(7469),p=a(4529),v=a(1794),j=a(8262),y=a(9329);class b{handleError(e){if(e.response){var t;let a=(null==(t=e.response.data)?void 0:t.detail)||e.message;throw Error("Manager API Error ".concat(e.response.status,": ").concat(a))}if(e.request)throw Error("No response from Manager API");throw Error("Request error: ".concat(e.message))}async health(){return(await this.client.get("/health")).data}async status(){return(await this.client.get("/status")).data}async listAgents(){return(await this.client.get("/agents")).data.agents}async getAgent(e){return(await this.client.get("/agents/".concat(e))).data}async createAgent(e){return(await this.client.post("/agents",e)).data}async deleteAgent(e){return(await this.client.delete("/agents/".concat(e))).data}async listTemplates(){return(await this.client.get("/templates")).data}async getAllocatedPorts(){return(await this.client.get("/ports/allocated")).data}constructor(e){this.client=y.A.create({baseURL:e.baseURL,timeout:e.timeout||3e4,headers:{"Content-Type":"application/json",...e.headers}}),this.client.interceptors.request.use(e=>{let t=localStorage.getItem("manager_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,this.handleError)}}let w=e=>{let{open:t,onOpenChange:a,children:n}=e;return t?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50",onClick:()=>null==a?void 0:a(!1)}),(0,s.jsx)("div",{className:"relative bg-white rounded-lg shadow-lg",children:n})]}):null},N=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"p-6 ".concat(a),children:t})},C=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"mb-4",children:t})},A=e=>{let{children:t}=e;return(0,s.jsx)("h2",{className:"text-lg font-semibold",children:t})},k=e=>{let{children:t}=e;return(0,s.jsx)("p",{className:"text-sm text-gray-600",children:t})},S=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"mt-6 flex justify-end gap-2",children:t})},_=n.forwardRef((e,t)=>{let{className:a="",type:n,...r}=e;return(0,s.jsx)("input",{type:n,className:"flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),ref:t,...r})});_.displayName="Input";let E=n.forwardRef((e,t)=>{let{className:a="",...n}=e;return(0,s.jsx)("label",{ref:t,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ".concat(a),...n})});E.displayName="Label";let I=n.createContext({}),R=e=>{let{children:t,value:a,onValueChange:r,disabled:l}=e,[i,c]=n.useState(!1);return(0,s.jsx)(I.Provider,{value:{value:a,onValueChange:r,open:i,onOpenChange:c},children:(0,s.jsx)("div",{className:"relative",children:t})})},T=e=>{let{children:t,className:a=""}=e,{open:r,onOpenChange:l}=n.useContext(I);return(0,s.jsxs)("button",{type:"button",onClick:()=>null==l?void 0:l(!r),className:"flex h-10 w-full items-center justify-between rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(a),children:[t,(0,s.jsx)("svg",{className:"h-4 w-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},L=e=>{let{placeholder:t}=e,{value:a}=n.useContext(I);return(0,s.jsx)("span",{children:a||t||"Select..."})},P=e=>{let{children:t}=e,{open:a}=n.useContext(I);return a?(0,s.jsx)("div",{className:"absolute z-50 mt-1 w-full rounded-md border border-gray-300 bg-white shadow-lg",children:(0,s.jsx)("div",{className:"py-1",children:t})}):null},O=e=>{let{value:t,children:a}=e,{onValueChange:r,onOpenChange:l}=n.useContext(I);return(0,s.jsx)("div",{className:"cursor-pointer px-3 py-2 text-sm hover:bg-gray-100",onClick:()=>{null==r||r(t),null==l||l(!1)},children:a})},M=n.forwardRef((e,t)=>{let{className:a="",...n}=e;return(0,s.jsx)("textarea",{className:"flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),ref:t,...n})});M.displayName="Textarea";var V=a(4057),U=a(8130),D=a(5958);function F(e){var t;let{open:a,onOpenChange:r,onAgentCreated:l,managerClient:f}=e,[p,v]=(0,n.useState)(null),[j,y]=(0,n.useState)(!1),[b,I]=(0,n.useState)(!1),[F,W]=(0,n.useState)(null),[B,$]=(0,n.useState)({template:"",name:"",environment:{},wa_signature:""}),[z,K]=(0,n.useState)([{key:"",value:""}]),[Q,q]=(0,n.useState)(""),[Y,Z]=(0,n.useState)(!1),H=(e,t)=>{if(["TOKEN","KEY","SECRET","PASSWORD","PASS","PWD","AUTH","CREDENTIAL","API_KEY","ACCESS_KEY","PRIVATE"].some(t=>e.toUpperCase().includes(t))&&t&&t.length>0)if(t.length>8)return"".concat(t.slice(0,4),"...").concat(t.slice(-4));else return"****";return t},J=e=>{let t=e.split("\n"),a=[];return t.forEach(e=>{let t=e.trim();if(t&&!t.startsWith("#")){let[e,...s]=t.split("=");e&&a.push({key:e.trim(),value:s.join("=").trim()})}}),a},G=async()=>{try{let e=await fetch("/manager/v1/env/default");if(e.ok){let t=await e.json();if(t.content){q(t.content);let e=J(t.content);K(e.length>0?e:[{key:"",value:""}])}}}catch(e){console.error("Failed to load default .env:",e)}};(0,n.useEffect)(()=>{a&&(X(),G())},[a]);let X=async()=>{y(!0);try{let e=await f.listTemplates();v(e),e.pre_approved.length>0&&$(t=>({...t,template:e.pre_approved[0]}))}catch(e){W(e instanceof Error?e.message:"Failed to fetch templates")}finally{y(!1)}},ee=async e=>{e.preventDefault(),W(null),I(!0);try{let e={};z.forEach(t=>{let{key:a,value:s}=t;a.trim()&&(e[a]=s)});let t={...B,environment:Object.keys(e).length>0?e:void 0};await f.createAgent(t),l(),$({template:(null==p?void 0:p.pre_approved[0])||"",name:"",environment:{},wa_signature:""}),K([{key:"",value:""}])}catch(e){W(e instanceof Error?e.message:"Failed to create agent")}finally{I(!1)}},et=e=>{K(z.filter((t,a)=>a!==e))},ea=(e,t,a)=>{let s=[...z];s[e][t]=a,K(s)},es=null!=(t=null==p?void 0:p.pre_approved.includes(B.template))&&t;return(0,s.jsx)(w,{open:a,onOpenChange:r,children:(0,s.jsxs)(N,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[(0,s.jsxs)(C,{children:[(0,s.jsx)(A,{children:"Create New Agent"}),(0,s.jsx)(k,{children:"Deploy a new CIRIS agent instance with the selected template"})]}),(0,s.jsx)("form",{id:"create-agent-form",onSubmit:ee,className:"flex flex-col flex-1 overflow-hidden",children:(0,s.jsxs)("div",{className:"space-y-4 py-4 overflow-y-auto flex-1 px-1",children:[F&&(0,s.jsx)(g,{variant:"destructive",children:(0,s.jsx)(m,{children:F})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(E,{htmlFor:"template",children:"Template"}),(0,s.jsxs)(R,{value:B.template,onValueChange:e=>$({...B,template:e}),disabled:j||!p,children:[(0,s.jsx)(T,{children:(0,s.jsx)(L,{placeholder:"Select a template"})}),(0,s.jsx)(P,{children:p&&Object.entries(p.templates).map(e=>{let[t,a]=e;return(0,s.jsx)(O,{value:t,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:t}),p.pre_approved.includes(t)&&(0,s.jsx)(u,{variant:"secondary",className:"text-xs",children:"Pre-approved"})]})},t)})})]}),!es&&B.template&&(0,s.jsxs)(g,{children:[(0,s.jsx)(V.A,{className:"h-4 w-4"}),(0,s.jsx)(m,{children:"This template requires Wise Authority approval. Please provide a signature below."})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(E,{htmlFor:"name",children:"Agent Name"}),(0,s.jsx)(_,{id:"name",value:B.name,onChange:e=>$({...B,name:e.target.value}),placeholder:"my-agent",required:!0})]}),!es&&B.template&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(E,{htmlFor:"wa_signature",children:"Wise Authority Signature"}),(0,s.jsx)(M,{id:"wa_signature",value:B.wa_signature,onChange:e=>$({...B,wa_signature:e.target.value}),placeholder:"Ed25519 signature from Wise Authority",rows:3,required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(E,{children:"Environment Variables (Optional)"}),(0,s.jsxs)(i,{defaultValue:"keyvalue",children:[(0,s.jsxs)(c,{className:"grid w-full grid-cols-2",children:[(0,s.jsx)(o,{value:"keyvalue",children:"Key-Value"}),(0,s.jsx)(o,{value:"envfile",children:".env File"})]}),(0,s.jsxs)(d,{value:"keyvalue",className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(h.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>Z(!Y),children:[Y?(0,s.jsx)(U.A,{className:"h-4 w-4"}):(0,s.jsx)(D.A,{className:"h-4 w-4"}),Y?"Hide Values":"Show Values"]})}),(0,s.jsx)(h.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{K([...z,{key:"",value:""}])},children:"Add Variable"})]}),(0,s.jsx)("div",{className:"space-y-2",children:z.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(_,{placeholder:"Key",value:e.key,onChange:e=>ea(t,"key",e.target.value)}),(0,s.jsx)(_,{placeholder:"Value",type:Y?"text":"password",value:Y?e.value:H(e.key,e.value),onChange:e=>ea(t,"value",e.target.value),disabled:!Y&&H(e.key,e.value)!==e.value}),(0,s.jsx)(h.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>et(t),disabled:1===z.length,children:"Remove"})]},t))})]}),(0,s.jsxs)(d,{value:"envfile",className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsxs)(h.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>Z(!Y),children:[Y?(0,s.jsx)(U.A,{className:"h-4 w-4"}):(0,s.jsx)(D.A,{className:"h-4 w-4"}),Y?"Hide Sensitive Values":"Show All Values"]}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Sensitive values are redacted for security"})]}),(0,s.jsx)(M,{placeholder:"Paste your .env file content here...",value:Y?Q:Q.split("\n").map(e=>{let t=e.trim();if(t&&!t.startsWith("#")){let[e,...a]=t.split("=");if(e){let t=a.join("=").trim(),s=H(e.trim(),t);if(s!==t)return"".concat(e,"=").concat(s)}}return e}).join("\n"),onChange:e=>{q(e.target.value);let t=J(e.target.value);K(t.length>0?t:[{key:"",value:""}])},rows:8,className:"font-mono text-sm"}),Q&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[J(Q).length," variables detected"]})]})]})]})]})}),(0,s.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,s.jsxs)(S,{children:[(0,s.jsx)(h.$,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:b,children:"Cancel"}),(0,s.jsx)(h.$,{type:"submit",form:"create-agent-form",disabled:b||!B.template||!B.name,children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Agent"})]})})]})})}var W=a(2942),B=a(9484);function $(e){let{children:t}=e,{isManagerAuthenticated:a,loading:r}=(0,B.A)(),l=(0,W.useRouter)();return((0,n.useEffect)(()=>{r||a()||l.push("/login")},[r,a,l]),r)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"text-lg",children:"Loading..."})}):a()?(0,s.jsx)(s.Fragment,{children:t}):null}function z(){return(0,s.jsx)($,{children:(0,s.jsx)(K,{})})}function K(){let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(null),[y,w]=(0,n.useState)(!0),[N,C]=(0,n.useState)(null),[A,k]=(0,n.useState)(!1),[S,_]=(0,n.useState)(!1),E=new b({baseURL:"/manager/v1"}),I=async()=>{try{C(null);let[e,a]=await Promise.all([E.listAgents(),E.status()]);t(e),l(a)}catch(e){C(e instanceof Error?e.message:"Failed to fetch data")}finally{w(!1),_(!1)}};(0,n.useEffect)(()=>{I()},[]);let R=async e=>{if(confirm("Are you sure you want to delete agent ".concat(e,"?")))try{await E.deleteAgent(e),await I()}catch(e){C(e instanceof Error?e.message:"Failed to delete agent")}};return y?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(x.A,{className:"h-8 w-8 animate-spin"})}):(0,s.jsxs)("div",{className:"container mx-auto p-6",children:[(0,s.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"CIRIS Manager"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage your CIRIS agents and infrastructure"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>{_(!0),I()},disabled:S,children:[(0,s.jsx)(f.A,{className:"h-4 w-4 mr-2 ".concat(S?"animate-spin":"")}),"Refresh"]}),(0,s.jsxs)(h.$,{onClick:()=>k(!0),children:[(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Create Agent"]})]})]}),N&&(0,s.jsx)(g,{variant:"destructive",className:"mb-6",children:(0,s.jsx)(m,{children:N})}),(0,s.jsxs)(i,{defaultValue:"agents",className:"space-y-4",children:[(0,s.jsxs)(c,{children:[(0,s.jsx)(o,{value:"agents",children:"Agents"}),(0,s.jsx)(o,{value:"status",children:"Manager Status"})]}),(0,s.jsx)(d,{value:"agents",className:"space-y-4",children:(0,s.jsxs)(r.Zp,{children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)(r.ZB,{children:"Active Agents"}),(0,s.jsxs)(r.BT,{children:[e.length," agent",1!==e.length?"s":""," currently running"]})]}),(0,s.jsx)(r.Wu,{children:0===e.length?(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No agents running. Create one to get started."}):(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,s.jsx)("div",{className:"border rounded-lg p-4 hover:bg-accent/50 transition-colors",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{className:"h-4 w-4"}),(0,s.jsx)("h3",{className:"font-semibold",children:e.name}),(0,s.jsx)(u,{variant:"secondary",children:e.template})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["ID: ",e.agent_id]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Port: ",e.port," â€¢ API: ",e.api_endpoint]}),e.created_at&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(e.created_at).toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(h.$,{variant:"outline",size:"sm",onClick:()=>window.open("".concat(e.api_endpoint,"/docs"),"_blank"),children:"Open API"}),(0,s.jsx)(h.$,{variant:"ghost",size:"sm",onClick:()=>R(e.agent_id),children:(0,s.jsx)(j.A,{className:"h-4 w-4"})})]})]})},e.agent_id))})})]})}),(0,s.jsx)(d,{value:"status",className:"space-y-4",children:(0,s.jsxs)(r.Zp,{children:[(0,s.jsxs)(r.aR,{children:[(0,s.jsx)(r.ZB,{children:"Manager Status"}),(0,s.jsx)(r.BT,{children:"Current status of the CIRIS Manager service"})]}),(0,s.jsx)(r.Wu,{className:"space-y-4",children:a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Status:"}),(0,s.jsx)(u,{variant:"running"===a.status?"default":"secondary",children:a.status})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold",children:"Version:"})," ",a.version]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"Components:"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(a.components).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between bg-accent/30 rounded p-2",children:[(0,s.jsx)("span",{className:"text-sm",children:t}),(0,s.jsx)(u,{variant:"outline",className:"text-xs",children:a})]},t)})})]})]})})]})})]}),(0,s.jsx)(F,{open:A,onOpenChange:k,onAgentCreated:()=>{k(!1),I()},managerClient:E})]})}},3120:(e,t,a)=>{"use strict";a.d(t,{_:()=>i});var s=a(704);function n(){let e=window.location.hostname,t=window.location.pathname,a=t.startsWith("/agent/");if("agents.ciris.ai"!==e&&!a)return{mode:"standalone",agentId:"default",apiBase:"/v1"};{let e="default";e=a?t.split("/")[2]||"default":localStorage.getItem("selectedAgentId")||"default";let s="/api/".concat(e,"/v1");return{mode:"managed",agentId:e,apiBase:s}}}var r=a(5950);class l{configure(e,t){let a,{mode:s}=n();if("managed"===s)a="".concat(window.location.origin,"/api/").concat(e);else{let t=localStorage.getItem("agent_".concat(e,"_api_url"));a=t||window.location.origin}t||(t=r.a.getAccessToken()||void 0);let l={baseURL:a,authToken:t,agentId:e,mode:s};return this.hasConfigChanged(l)&&this.applyConfiguration(l),l}configureForOAuthCallback(e,t){let a,{mode:s}=n(),r={baseURL:"managed"===s?"".concat(window.location.origin,"/api/").concat(e):window.location.origin,authToken:t,agentId:e,mode:s};return this.applyConfiguration(r),this.storeConfiguration(r),r}getCurrentConfig(){return this.currentConfig}isConfiguredFor(e){return!!this.currentConfig&&this.currentConfig.agentId===e&&!!this.currentConfig.authToken}clear(){this.currentConfig=null,localStorage.removeItem("sdk_config"),this.log("SDK configuration cleared")}applyConfiguration(e){this.log("Applying SDK configuration:",e),s.AQ.setConfig({baseURL:e.baseURL,authToken:e.authToken}),this.currentConfig=e,this.log("SDK configured successfully")}hasConfigChanged(e){return!this.currentConfig||this.currentConfig.baseURL!==e.baseURL||this.currentConfig.authToken!==e.authToken||this.currentConfig.agentId!==e.agentId||this.currentConfig.mode!==e.mode}storeConfiguration(e){let t={baseURL:e.baseURL,agentId:e.agentId,mode:e.mode};localStorage.setItem("sdk_config",JSON.stringify(t)),"standalone"===e.mode&&e.baseURL!==window.location.origin&&localStorage.setItem("agent_".concat(e.agentId,"_api_url"),e.baseURL)}restoreConfiguration(){let e=localStorage.getItem("sdk_config");if(!e)return null;try{let t=JSON.parse(e),a=r.a.getAccessToken()||void 0;return{...t,authToken:a}}catch(e){return null}}log(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];this.debugMode&&console.log("[SDKConfigManager]",...t)}constructor(){this.currentConfig=null,this.debugMode=!1}}let i=new l},9404:(e,t,a)=>{"use strict";a.d(t,{BT:()=>i,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>r});var s=a(4568);a(7620);let n=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"rounded-lg border bg-white shadow-sm ".concat(a),children:t})},r=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"flex flex-col space-y-1.5 p-6 ".concat(a),children:t})},l=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight ".concat(a),children:t})},i=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("p",{className:"text-sm text-gray-600 ".concat(a),children:t})},c=e=>{let{children:t,className:a=""}=e;return(0,s.jsx)("div",{className:"p-6 pt-0 ".concat(a),children:t})}},9484:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,O:()=>d});var s=a(4568),n=a(7620),r=a(2942),l=a(3237),i=a(704),c=a(3120);let o=(0,n.createContext)(void 0);function d(e){let{children:t}=e,[a,d]=(0,n.useState)(null),[u,h]=(0,n.useState)(!0),[g,m]=(0,n.useState)(null),x=(0,r.useRouter)();(0,n.useEffect)(()=>{let e=window.location.pathname;"/login"===e||e.startsWith("/manager")?h(!1):f();let t=localStorage.getItem("manager_token");t&&m(t)},[]);let f=async()=>{try{if(i.AQ.isAuthenticated()){let e=await i.AQ.auth.getMe();d(e)}}catch(e){console.error("Auth check failed:",e)}finally{h(!1)}},p=(0,n.useCallback)(async(e,t)=>{try{let a=localStorage.getItem("selectedAgentId");if(!a)throw Error("No agent selected");c._.configure(a);let s=await i.AQ.login(e,t),n=i.AQ.auth.getAccessToken();n&&c._.configure(a,n),d(s),l.Ay.success("Welcome, ".concat(s.username||s.user_id,"!")),x.push("/")}catch(e){throw l.Ay.error(e.message||"Login failed"),e}},[x]),v=(0,n.useCallback)(async()=>{try{await i.AQ.logout(),d(null),l.Ay.success("Logged out successfully"),x.push("/login")}catch(e){console.error("Logout failed:",e),l.Ay.error("Logout failed")}},[x]),j=(0,n.useCallback)(e=>!!a&&(a.permissions.includes(e)||"SYSTEM_ADMIN"===a.role),[a]),y=(0,n.useCallback)(e=>{if(!a)return!1;let t=["OBSERVER","ADMIN","AUTHORITY","SYSTEM_ADMIN"];return t.indexOf(a.role)>=t.indexOf(e)},[a]),b=(0,n.useCallback)(e=>{i.AQ.setConfig({authToken:e})},[]),w=(0,n.useCallback)(()=>!!g,[g]);return(0,s.jsx)(o.Provider,{value:{user:a,loading:u,login:p,logout:v,hasPermission:j,hasRole:y,setUser:d,setToken:b,managerToken:g,setManagerToken:m,isManagerAuthenticated:w},children:t})}function u(){let e=(0,n.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4534,6224,704,587,8315,7358],()=>t(702)),_N_E=e.O()}]);