(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7522],{6927:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});var s=t(4568),i=t(7620),a=t(704);let n=[{productId:"credits_100",credits:100,price:"$4.99",priceMinor:499,description:"100 CIRIS credits"},{productId:"credits_250",credits:250,price:"$9.99",priceMinor:999,description:"250 CIRIS credits - Best Value!"},{productId:"credits_600",credits:600,price:"$19.99",priceMinor:1999,description:"600 CIRIS credits - Most Popular!"}];function l(e){let{credits:r,onPurchaseClick:t}=e;if(!r)return(0,s.jsx)("div",{className:"animate-pulse bg-gray-200 h-20 rounded-lg"});let i=r.free_uses_remaining>0,a=r.credits_remaining<5&&0===r.free_uses_remaining,n=!r.has_credit,l="\uD83D\uDCB5",c="text-blue-600 bg-blue-50 border-blue-200",d="".concat(r.credits_remaining," credits remaining");return i?(l="\uD83C\uDF81",c=1===r.free_uses_remaining?"text-orange-600 bg-orange-50 border-orange-200":"text-green-600 bg-green-50 border-green-200",d="".concat(r.free_uses_remaining," free tries remaining")):n?(l="\uD83D\uDCB3",c="text-red-600 bg-red-50 border-red-200",d="0 credits remaining"):a&&(l="⚠️",c="text-orange-600 bg-orange-50 border-orange-200",d="".concat(r.credits_remaining," credits remaining")),(0,s.jsx)("div",{className:"".concat(c," border-2 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-shadow"),onClick:()=>(n||a)&&t(),children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{className:"text-5xl",children:l}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:d}),(0,s.jsxs)("p",{className:"text-sm mt-1",children:[i&&"Try CIRIS for free! No credit card required.",n&&"Purchase more uses to continue",a&&!i&&"Running low! Purchase more to avoid interruptions",!n&&!a&&!i&&"Click to purchase more"]})]}),(n||a)&&(0,s.jsx)("button",{className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Purchase"})]})})}function c(e){let{product:r,onPurchase:t,isPopular:i}=e;return(0,s.jsxs)("div",{className:"relative border-2 rounded-xl p-6 transition-all hover:shadow-lg ".concat(i?"border-blue-500 bg-gradient-to-br from-blue-50 to-white":"border-gray-200 bg-white hover:border-blue-300"),children:[i&&(0,s.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:(0,s.jsx)("span",{className:"bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full",children:"MOST POPULAR"})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-4xl font-bold text-gray-900 mb-2",children:r.credits}),(0,s.jsx)("div",{className:"text-gray-600 mb-4",children:"credits"}),(0,s.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:r.price}),(0,s.jsxs)("div",{className:"text-sm text-gray-500 mb-4",children:["$",(r.priceMinor/r.credits/100).toFixed(3)," per credit"]}),(0,s.jsx)("button",{onClick:()=>t(r.productId),className:"w-full py-3 rounded-lg font-medium transition-colors ".concat(i?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-900 hover:bg-gray-200"),children:"Purchase"})]})]})}function d(e){let{isOpen:r,onClose:t,onSuccess:a,credits:l}=e,[d,o]=(0,i.useState)("prompt"),[x,u]=(0,i.useState)(null),[m,g]=(0,i.useState)(null),h=e=>{g(e),o("processing"),window.location.href="ciris://purchase/".concat(e),setTimeout(()=>{o("prompt"),t(),setTimeout(()=>{a()},2e3)},1e3)};return r?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 animate-fade-in max-h-[90vh] overflow-y-auto",children:["prompt"===d&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Purchase Credits"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:(null==l?void 0:l.free_uses_remaining)===0?"You've used your free tries! Purchase credits to continue.":"Choose a credit package to continue using CIRIS."})]}),(0,s.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,s.jsx)(c,{product:e,onPurchase:h,isPopular:"credits_600"===e.productId},e.productId))}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 justify-center",children:[(0,s.jsx)("span",{children:"\uD83D\uDD12"}),(0,s.jsx)("span",{children:"Secure payment via Google Play"})]}),(0,s.jsx)("button",{onClick:t,className:"w-full px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Not now"})]}),"processing"===d&&(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"text-gray-600 mt-4",children:"Opening Google Play..."}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"Complete your purchase in the dialog"})]}),"success"===d&&(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"✓"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-green-600 mb-2",children:"Purchase Successful!"}),(0,s.jsx)("p",{className:"text-gray-700",children:"Credits have been added to your account"})]}),"error"===d&&(0,s.jsxs)("div",{className:"text-center py-8 space-y-6",children:[(0,s.jsx)("div",{className:"text-6xl text-red-500",children:"✕"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Purchase Failed"}),(0,s.jsx)("p",{className:"text-gray-600",children:x})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{u(null),o("prompt")},className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Try Again"}),(0,s.jsx)("button",{onClick:t,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancel"})]})]})]})}):null}function o(){let[e,r]=(0,i.useState)(null),[t,o]=(0,i.useState)(!0),[x,u]=(0,i.useState)(null),[m,g]=(0,i.useState)(!1),[h,p]=(0,i.useState)(!1),[b]=(0,i.useState)(()=>new a.CIRISClient),j=async()=>{o(!0),u(null);try{let e=await b.billing.getCredits();r(e)}catch(e){console.error("Failed to load credits:",e),u("Failed to load credit information. Please try again.")}finally{o(!1)}};(0,i.useEffect)(()=>{j(),p(function(){try{let e=localStorage.getItem("ciris_native_auth");if(e){let r=JSON.parse(e);return!0===r.isNativeApp}return"true"===localStorage.getItem("isNativeApp")}catch(e){return!1}}());let e=e=>{console.log("Purchase complete event received:",e.detail),j()};return window.addEventListener("ciris_purchase_complete",e),()=>{window.removeEventListener("ciris_purchase_complete",e)}},[]);let f=e=>{window.location.href="ciris://purchase/".concat(e)};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"Billing"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your CIRIS credits and purchases"}),h&&(0,s.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Powered by Google Play"})]}),t&&(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,s.jsx)("div",{className:"h-64 bg-gray-200 rounded-lg"})]}),x&&!t&&(0,s.jsxs)("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-6 text-center",children:[(0,s.jsx)("div",{className:"text-4xl mb-2",children:"⚠️"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-red-900 mb-2",children:"Connection Error"}),(0,s.jsx)("p",{className:"text-red-700 mb-4",children:x}),(0,s.jsx)("button",{onClick:j,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Retry"})]}),!t&&!x&&e&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(l,{credits:e,onPurchaseClick:()=>g(!0)}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Usage Statistics"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Uses"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.total_uses})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Current Plan"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.plan_name})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Free Uses"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:e.free_uses_remaining})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Paid Credits"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:Math.max(0,e.credits_remaining-e.free_uses_remaining)})]})]})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Purchase Credits"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:n.map(e=>(0,s.jsx)(c,{product:e,onPurchase:f,isPopular:"credits_600"===e.productId},e.productId))})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,s.jsx)("h3",{className:"font-bold text-blue-900 mb-2",children:"About Credits"}),(0,s.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,s.jsx)("li",{children:"• Each interaction with CIRIS uses one credit"}),(0,s.jsx)("li",{children:"• Free tries are provided to new users"}),(0,s.jsx)("li",{children:"• Purchased credits never expire"}),(0,s.jsx)("li",{children:"• Secure payments via Google Play"})]})]})]}),(0,s.jsx)(d,{isOpen:m,onClose:()=>g(!1),onSuccess:()=>{j()},credits:e})]})})}},7032:(e,r,t)=>{Promise.resolve().then(t.bind(t,6927))},7932:(e,r,t)=>{"use strict";function s(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var s in t)e[s]=t[s]}return e}t.d(r,{A:()=>i});var i=function e(r,t){function i(e,i,a){if("undefined"!=typeof document){"number"==typeof(a=s({},t,a)).expires&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var n="";for(var l in a)a[l]&&(n+="; "+l,!0!==a[l]&&(n+="="+a[l].split(";")[0]));return document.cookie=e+"="+r.write(i,e)+n}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],s={},i=0;i<t.length;i++){var a=t[i].split("="),n=a.slice(1).join("=");try{var l=decodeURIComponent(a[0]);if(s[l]=r.read(n,l),e===l)break}catch(e){}}return e?s[e]:s}},remove:function(e,r){i(e,"",s({},r,{expires:-1}))},withAttributes:function(r){return e(this.converter,s({},this.attributes,r))},withConverter:function(r){return e(s({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(r)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}},e=>{var r=r=>e(e.s=r);e.O(0,[704,587,8315,7358],()=>r(7032)),_N_E=e.O()}]);
