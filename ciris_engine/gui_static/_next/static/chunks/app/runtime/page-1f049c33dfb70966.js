(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1553],{589:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,s:()=>i});var a=s(494),r=s(6759),n=s(1279),i=class extends r.k{#e;#t;#s;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||o(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||("pending"===this.state.status?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(e){let t=()=>{this.#a({type:"continue"})};this.#s=(0,n.II)({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(Error("No mutationFn found")),onFail:(e,t)=>{this.#a({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#a({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});let s="pending"===this.state.status,a=!this.#s.canStart();try{if(s)t();else{this.#a({type:"pending",variables:e,isPaused:a}),await this.#t.config.onMutate?.(e,this);let t=await this.options.onMutate?.(e);t!==this.state.context&&this.#a({type:"pending",context:t,variables:e,isPaused:a})}let r=await this.#s.start();return await this.#t.config.onSuccess?.(r,e,this.state.context,this),await this.options.onSuccess?.(r,e,this.state.context),await this.#t.config.onSettled?.(r,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(r,null,e,this.state.context),this.#a({type:"success",data:r}),r}catch(t){try{throw await this.#t.config.onError?.(t,e,this.state.context,this),await this.options.onError?.(t,e,this.state.context),await this.#t.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,t,e,this.state.context),t}finally{this.#a({type:"error",error:t})}}finally{this.#t.runNext(this)}}#a(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),a.jG.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function o(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},1739:(e,t,s)=>{Promise.resolve().then(s.bind(s,6652))},2942:(e,t,s)=>{"use strict";var a=s(2418);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},3120:(e,t,s)=>{"use strict";s.d(t,{_:()=>o});var a=s(704);function r(){let e=window.location.hostname,t=window.location.pathname,s=t.startsWith("/agent/");if("agents.ciris.ai"!==e&&!s)return{mode:"standalone",agentId:"default",apiBase:"/v1"};{let e="default";e=s?t.split("/")[2]||"default":localStorage.getItem("selectedAgentId")||"default";let a="/api/".concat(e,"/v1");return{mode:"managed",agentId:e,apiBase:a}}}var n=s(5950);class i{configure(e,t){let s,{mode:a}=r();if("managed"===a)s="".concat(window.location.origin,"/api/").concat(e);else{let t=localStorage.getItem("agent_".concat(e,"_api_url"));s=t||window.location.origin}t||(t=n.a.getAccessToken()||void 0);let i={baseURL:s,authToken:t,agentId:e,mode:a};return this.hasConfigChanged(i)&&this.applyConfiguration(i),i}configureForOAuthCallback(e,t){let s,{mode:a}=r(),n={baseURL:"managed"===a?"".concat(window.location.origin,"/api/").concat(e):window.location.origin,authToken:t,agentId:e,mode:a};return this.applyConfiguration(n),this.storeConfiguration(n),n}getCurrentConfig(){return this.currentConfig}isConfiguredFor(e){return!!this.currentConfig&&this.currentConfig.agentId===e&&!!this.currentConfig.authToken}clear(){this.currentConfig=null,localStorage.removeItem("sdk_config"),this.log("SDK configuration cleared")}applyConfiguration(e){this.log("Applying SDK configuration:",e),a.AQ.setConfig({baseURL:e.baseURL,authToken:e.authToken}),this.currentConfig=e,this.log("SDK configured successfully")}hasConfigChanged(e){return!this.currentConfig||this.currentConfig.baseURL!==e.baseURL||this.currentConfig.authToken!==e.authToken||this.currentConfig.agentId!==e.agentId||this.currentConfig.mode!==e.mode}storeConfiguration(e){let t={baseURL:e.baseURL,agentId:e.agentId,mode:e.mode};localStorage.setItem("sdk_config",JSON.stringify(t)),"standalone"===e.mode&&e.baseURL!==window.location.origin&&localStorage.setItem("agent_".concat(e.agentId,"_api_url"),e.baseURL)}restoreConfiguration(){let e=localStorage.getItem("sdk_config");if(!e)return null;try{let t=JSON.parse(e),s=n.a.getAccessToken()||void 0;return{...t,authToken:s}}catch(e){return null}}log(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];this.debugMode&&console.log("[SDKConfigManager]",...t)}constructor(){this.currentConfig=null,this.debugMode=!1}}let o=new i},4893:(e,t,s)=>{"use strict";s.d(t,{DP:()=>f,HG:()=>u,Nl:()=>l,O4:()=>d,Pi:()=>i,RR:()=>h,RY:()=>p,Rv:()=>v,XR:()=>o,Zu:()=>N,bN:()=>g,c1:()=>C,fC:()=>w,fK:()=>_,lm:()=>x,md:()=>S,mo:()=>n,uc:()=>y,ui:()=>c,vK:()=>m,xZ:()=>b,xm:()=>j});var a=s(4568);s(7620);let r={xs:{width:12,height:12},sm:{width:16,height:16},md:{width:20,height:20},lg:{width:24,height:24}},n=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})},i=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})},o=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M11 17a1 1 0 001.447.894l4-2A1 1 0 0017 15V9.236a1 1 0 00-1.447-.894l-4 2a1 1 0 00-.553.894V17zM15.211 6.276a1 1 0 000-1.788l-4.764-2.382a1 1 0 00-.894 0L4.789 4.488a1 1 0 000 1.788l4.764 2.382a1 1 0 00.894 0l4.764-2.382zM4.447 8.342A1 1 0 003 9.236V15a1 1 0 00.553.894l4 2A1 1 0 009 17v-5.764a1 1 0 00-.553-.894l-4-2z"})})},l=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsxs)("svg",{className:"animate-spin ".concat(t),width:n,height:i,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},c=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})},d=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},u=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})},m=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})},p=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 8a6 6 0 01-7.743 5.743L10 14l-1 1-1 1H6v2H2v-4l4.257-4.257A6 6 0 1118 8zm-6-4a1 1 0 100 2 2 2 0 012 2 1 1 0 102 0 4 4 0 00-4-4z",clipRule:"evenodd"})})},h=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M2 5a2 2 0 012-2h12a2 2 0 012 2v2a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm14 1a1 1 0 11-2 0 1 1 0 012 0zM2 13a2 2 0 012-2h12a2 2 0 012 2v2a2 2 0 01-2 2H4a2 2 0 01-2-2v-2zm14 1a1 1 0 11-2 0 1 1 0 012 0z",clipRule:"evenodd"})})},g=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsxs)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:[(0,a.jsx)("path",{d:"M3 12v3c0 1.657 3.134 3 7 3s7-1.343 7-3v-3c0 1.657-3.134 3-7 3s-7-1.343-7-3z"}),(0,a.jsx)("path",{d:"M3 7v3c0 1.657 3.134 3 7 3s7-1.343 7-3V7c0 1.657-3.134 3-7 3S3 8.657 3 7z"}),(0,a.jsx)("path",{d:"M17 5c0 1.657-3.134 3-7 3S3 6.657 3 5s3.134-3 7-3 7 1.343 7 3z"})]})},x=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},f=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})},v=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{d:"M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z"})})},_=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})},N=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},y=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})},C=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})},w=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},b=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})},j=e=>{let{className:t="",size:s="md"}=e,{width:n,height:i}=r[s];return(0,a.jsx)("svg",{className:t,width:n,height:i,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},S=e=>{let{status:t,className:s=""}=e;return(0,a.jsx)("span",{className:"w-3 h-3 rounded-full ".concat({green:"bg-green-500",yellow:"bg-yellow-500",red:"bg-red-500",gray:"bg-gray-500"}[t]," ").concat(s)})}},6258:(e,t,s)=>{"use strict";s.d(t,{n:()=>d});var a=s(7620),r=s(589),n=s(494),i=s(2327),o=s(7703),l=class extends i.Q{#r;#n=void 0;#i;#o;constructor(e,t){super(),this.#r=e,this.setOptions(t),this.bindMethods(),this.#l()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#r.defaultMutationOptions(e),(0,o.f8)(this.options,t)||this.#r.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#i,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.EN)(t.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():this.#i?.state.status==="pending"&&this.#i.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#i?.removeObserver(this)}onMutationUpdate(e){this.#l(),this.#c(e)}getCurrentResult(){return this.#n}reset(){this.#i?.removeObserver(this),this.#i=void 0,this.#l(),this.#c()}mutate(e,t){return this.#o=t,this.#i?.removeObserver(this),this.#i=this.#r.getMutationCache().build(this.#r,this.options),this.#i.addObserver(this),this.#i.execute(e)}#l(){let e=this.#i?.state??(0,r.$)();this.#n={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#c(e){n.jG.batch(()=>{if(this.#o&&this.hasListeners()){let t=this.#n.variables,s=this.#n.context;e?.type==="success"?(this.#o.onSuccess?.(e.data,t,s),this.#o.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#o.onError?.(e.error,t,s),this.#o.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#n)})})}},c=s(7606);function d(e,t){let s=(0,c.jE)(t),[r]=a.useState(()=>new l(s,e));a.useEffect(()=>{r.setOptions(e)},[r,e]);let i=a.useSyncExternalStore(a.useCallback(e=>r.subscribe(n.jG.batchCalls(e)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),d=a.useCallback((e,t)=>{r.mutate(e,t).catch(o.lQ)},[r]);if(i.error&&(0,o.GU)(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:d,mutateAsync:i.mutate}}},6652:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(4568),r=s(7620),n=s(7606),i=s(3297),o=s(6258),l=s(704),c=s(9484),d=s(3237),u=s(4893),m=function(e){return e.START_ROUND="START_ROUND",e.GATHER_CONTEXT="GATHER_CONTEXT",e.PERFORM_DMAS="PERFORM_DMAS",e.PERFORM_ASPDMA="PERFORM_ASPDMA",e.CONSCIENCE_EXECUTION="CONSCIENCE_EXECUTION",e.RECURSIVE_ASPDMA="RECURSIVE_ASPDMA",e.RECURSIVE_CONSCIENCE="RECURSIVE_CONSCIENCE",e.FINALIZE_ACTION="FINALIZE_ACTION",e.PERFORM_ACTION="PERFORM_ACTION",e.ACTION_COMPLETE="ACTION_COMPLETE",e.ROUND_COMPLETE="ROUND_COMPLETE",e}(m||{});function p(){let{hasRole:e}=(0,c.A)();(0,n.jE)();let[t,s]=(0,r.useState)(null),[p,h]=(0,r.useState)(null),[g,x]=(0,r.useState)(null),[f,v]=(0,r.useState)("running"),[_,N]=(0,r.useState)([]),[y,C]=(0,r.useState)(!1),[w,b]=(0,r.useState)(null),j=(0,r.useRef)(null),[S,E]=(0,r.useState)(new Map),[R,A]=(0,r.useState)(new Set),[O,M]=(0,r.useState)([]),D=["bg-blue-500","bg-green-500","bg-purple-500","bg-orange-500","bg-red-500","bg-pink-500","bg-indigo-500","bg-yellow-500"],T=(0,r.useRef)(0),[k,I]=(0,r.useState)(new Map),[P,L]=(0,r.useState)(new Set),[U,z]=(0,r.useState)(new Set),{data:F,refetch:V}=(0,i.I)({queryKey:["runtime-state"],queryFn:()=>l.AQ.system.getRuntimeState(),refetchInterval:2e3}),B=(0,o.n)({mutationFn:async()=>{if(!e("ADMIN"))throw Error("Admin privileges required to execute single steps");return await l.AQ.system.singleStepProcessorEnhanced(!0)},onSuccess:e=>{d.Ay.success("Step completed: ".concat(e.message)),e.step_point&&console.log("Single step completed:",e.step_point),e.step_result&&h(e.step_result),x({processing_time_ms:e.processing_time_ms,tokens_used:e.tokens_used}),V()},onError:e=>{let t=e.message||"Unknown error";d.Ay.error("Step failed: ".concat(t))}}),H=(0,o.n)({mutationFn:()=>{if(!e("ADMIN"))throw Error("Admin privileges required to pause runtime");return l.AQ.system.pauseRuntime()},onSuccess:e=>{d.Ay.success("Runtime paused"),e.processor_state&&v(e.processor_state),V()},onError:e=>{let t=e.message||"Failed to pause runtime";d.Ay.error(t)}}),G=(0,o.n)({mutationFn:()=>{if(!e("ADMIN"))throw Error("Admin privileges required to resume runtime");return l.AQ.system.resumeRuntime()},onSuccess:e=>{d.Ay.success("Runtime resumed"),e.processor_state&&v("active"===e.processor_state?"running":e.processor_state),s(null),h(null),x(null),V()},onError:e=>{let t=e.message||"Failed to resume runtime";d.Ay.error(t)}}),W=e=>({START_ROUND:"0. Start Round",GATHER_CONTEXT:"1. Gather Context",PERFORM_DMAS:"2. Perform DMAs",PERFORM_ASPDMA:"3. Perform ASPDMA",CONSCIENCE_EXECUTION:"4. Conscience Execution",RECURSIVE_ASPDMA:"3B. Recursive ASPDMA",RECURSIVE_CONSCIENCE:"4B. Recursive Conscience",FINALIZE_ACTION:"5. Finalize Action",PERFORM_ACTION:"6. Perform Action",ACTION_COMPLETE:"7. Action Complete",ROUND_COMPLETE:"8. Round Complete"})[e]||e;(0,r.useEffect)(()=>{let e=l.AQ.auth.getAccessToken();if(!e)return void b("Authentication required for streaming");let t=l.AQ.getBaseURL(),a="".concat(t,"/v1/system/runtime/reasoning-stream");console.log("\uD83D\uDD0C Connecting to reasoning stream:",a),console.log("Token being used:",e.substring(0,20)+"...");let r=new AbortController;j.current=r;let n=(e,t)=>{console.log("\uD83C\uDFAF SSE Event received - Type: ".concat(e,", Data length: ").concat(t.length));try{if("connected"===e)console.log("✅ Stream connected:",t),C(!0),b(null);else if("step_update"===e){var a;let e=JSON.parse(t);console.log("\uD83D\uDCCA Step update received:",{thoughtCount:(null==(a=e.updated_thoughts)?void 0:a.length)||0,sequence:e.stream_sequence,updateType:e.update_type,fullUpdate:e}),e.updated_thoughts&&Array.isArray(e.updated_thoughts)&&I(t=>{let a=new Map(t);return e.updated_thoughts.forEach(t=>{let r,n=t.thought_id,i=t.task_id||"";console.log("\uD83D\uDD0D Full thought data:",t),console.log("\uD83D\uDCDD Thought summary:",{id:n,task_id:i,current_step:t.current_step,steps_completed:t.steps_completed,steps_remaining:t.steps_remaining,progress:t.progress_percentage,all_fields:Object.keys(t).join(", ")});let o=null;for(let[e,t]of a.entries())if(t.thoughts.has(n)){o=t.thoughts.get(n),i&&"unknown"!==i?i!==e&&"unknown"!==e&&(t.thoughts.delete(n),0===t.thoughts.size&&a.delete(e)):i=e;break}i||(i="unknown");let l=a.get(i);l||(l={task_id:i,thoughts:new Map,created_at:e.timestamp||new Date().toISOString(),last_updated:e.timestamp||new Date().toISOString()},a.set(i,l));let c=l.thoughts.get(n)||o;if(c||(c={thought_id:n,task_id:i,thought_type:t.thought_type||"unknown",status:t.status,current_step:t.current_step,steps:new Map,started_at:t.started_at,last_updated:e.timestamp||new Date().toISOString()}),l.thoughts.set(n,c),c&&(c.status=t.status,c.current_step=t.current_step,c.last_updated=e.timestamp||new Date().toISOString(),c.steps_completed=t.steps_completed,c.steps_remaining=t.steps_remaining,t.current_step&&et(n,i,t.current_step),"completed"===t.status||"complete"===t.status)){console.log("✅ Thought completed, ensuring all core steps are tracked");let t=c.steps;["START_ROUND","GATHER_CONTEXT","PERFORM_DMAS","PERFORM_ASPDMA","CONSCIENCE_EXECUTION","FINALIZE_ACTION","PERFORM_ACTION","ACTION_COMPLETE","ROUND_COMPLETE"].forEach(s=>{t.has(s)||(t.set(s,{step_point:s,step_name:s.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:"inferred",timestamp:e.timestamp||new Date().toISOString(),status:"completed",content_preview:"Step completed (inferred from thought completion)"}),console.log("➕ Added inferred completed step: ".concat(s)))})}if(t.completed_steps&&Array.isArray(t.completed_steps)&&c){console.log("\uD83D\uDCCB Found completed_steps array:",t.completed_steps);let s=c.steps;t.completed_steps.forEach(t=>{let a=t.toUpperCase().replace(/ /g,"_");s.has(a)||(s.set(a,{step_point:a,step_name:t.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:"completed",timestamp:e.timestamp||new Date().toISOString(),status:"completed"}),console.log("\uD83D\uDCCB Added completed step from array: ".concat(a)))})}if(t.step_history&&Array.isArray(t.step_history)&&c){console.log("\uD83D\uDCDC Found step_history:",t.step_history);let s=c.steps;t.step_history.forEach(t=>{let a=(t.step_name||t.step||t).toUpperCase().replace(/ /g,"_");!s.has(a)&&Object.values(m).includes(a)&&(s.set(a,{step_point:a,step_name:(t.step_name||t.step||t).replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:t.category||"historical",timestamp:t.timestamp||e.timestamp||new Date().toISOString(),status:t.status||"completed",processing_time_ms:t.processing_time_ms,content_preview:t.content_preview,step_result:t.result}),console.log("\uD83D\uDCDC Added step from history: ".concat(a)))})}if(t.pipeline_steps&&"object"==typeof t.pipeline_steps&&c){console.log("\uD83D\uDD27 Found pipeline_steps:",t.pipeline_steps);let s=c.steps;Object.entries(t.pipeline_steps).forEach(t=>{let[a,r]=t,n=a.toUpperCase().replace(/ /g,"_");!s.has(n)&&Object.values(m).includes(n)&&(s.set(n,{step_point:n,step_name:a.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:r.category||"pipeline",timestamp:r.timestamp||e.timestamp||new Date().toISOString(),status:r.status||"completed",processing_time_ms:r.processing_time_ms,content_preview:r.content_preview,step_result:r.result,transparency_data:r.transparency_data}),console.log("\uD83D\uDD27 Added step from pipeline: ".concat(n)))})}if(t.current_step&&(r=t.current_step,Object.values(m).includes(r)||(r=t.current_step.toUpperCase().replace(/ /g,"_")),console.log("\uD83C\uDFAF Step mapping:",{original:t.current_step,mapped:r,isValidEnum:Object.values(m).includes(r)})),r&&Object.values(m).includes(r)){let a={step_point:r,step_name:t.current_step.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:t.step_category||"unknown",timestamp:t.current_step_started_at||e.timestamp||new Date().toISOString(),status:t.status||"processing",processing_time_ms:t.processing_time_ms,content_preview:t.content_preview,error:t.last_error,step_result:t.step_result,transparency_data:t.transparency_data,progress_percentage:t.progress_percentage,round_number:t.round_number,stream_sequence:e.stream_sequence,raw_server_data:t};c.steps.set(r,a),console.log("✅ Stored step ".concat(r,", total steps: ").concat(c.steps.size)),s(r);let n=["START_ROUND","GATHER_CONTEXT","PERFORM_DMAS","PERFORM_ASPDMA","CONSCIENCE_EXECUTION","FINALIZE_ACTION","PERFORM_ACTION","ACTION_COMPLETE","ROUND_COMPLETE"],i=n.indexOf(r);if(console.log("\uD83D\uDCCD Current step index: ".concat(i," of ").concat(n.length)),i>0)for(let t=0;t<i;t++){let s=n[t];c.steps.has(s)||(c.steps.set(s,{step_point:s,step_name:s.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:"completed",timestamp:e.timestamp||new Date().toISOString(),status:"completed"}),console.log("⏮️ Backfilled completed step: ".concat(s)))}if(t.steps_remaining&&Array.isArray(t.steps_remaining)){let s=t.steps_remaining.length,a=9-s;console.log("\uD83D\uDCCA Steps progress: ".concat(a," completed, ").concat(s," remaining"));for(let t=0;t<a&&t<n.length;t++){let s=n[t];c.steps.has(s)||(c.steps.set(s,{step_point:s,step_name:s.replace(/_/g," ").toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()),step_category:"inferred",timestamp:e.timestamp||new Date().toISOString(),status:"completed",content_preview:"Step completed (inferred from remaining count)"}),console.log("\uD83D\uDCCA Inferred completed step from count: ".concat(s)))}}if("RECURSIVE_ASPDMA"===r||"RECURSIVE_CONSCIENCE"===r){let e=c.steps.get("CONSCIENCE_EXECUTION");e&&"completed"!==e.status&&(e.status="completed",e.error="Conscience check failed - triggered recursive analysis")}}t.total_processing_time_ms&&(c.total_processing_time_ms=t.total_processing_time_ms),l.last_updated=e.timestamp||new Date().toISOString()}),a});let r={timestamp:e.timestamp||new Date().toISOString(),step_point:e.current_step,pipeline_state:e};N(e=>[...e.slice(-99),r])}else if("keepalive"===e)console.log("\uD83D\uDC93 Keepalive:",t);else if("error"===e){let e=JSON.parse(t);console.error("❌ Stream error:",e),b("Stream error: ".concat(e.message||"Unknown error"))}}catch(t){console.error("Failed to process event:",e,t)}};return(async()=>{try{var t;let s=await fetch(a,{method:"GET",headers:{Authorization:"Bearer ".concat(e),Accept:"text/event-stream"},signal:r.signal});if(!s.ok)throw Error("HTTP ".concat(s.status,": ").concat(s.statusText));console.log("✅ Stream response received"),C(!0),b(null);let i=null==(t=s.body)?void 0:t.getReader(),o=new TextDecoder,l="";if(!i)throw Error("Response body is not readable");let c="",d="";for(;;){let{done:e,value:t}=await i.read();if(e){console.log("Stream ended"),c&&d&&n(c,d);break}let s=(l+=o.decode(t,{stream:!0})).split("\n");for(let e of(l=s.pop()||"",s))if(e.startsWith("event:"))c&&d&&n(c,d),c=e.slice(6).trim(),d="";else if(e.startsWith("data:")){let t=e.slice(5).trim();d=d?d+"\n"+t:t}else""===e&&c&&d&&(n(c,d),c="",d="")}}catch(e){"AbortError"!==e.name&&(console.error("❌ Stream connection error:",e),b("Connection failed: ".concat(e.message)),C(!1))}})(),()=>{console.log("\uD83D\uDD0C Closing stream connection"),r.abort(),j.current=null}},[]);let[q,Q]=(0,r.useState)(new Set),[K,X]=(0,r.useState)(""),[J,Z]=(0,r.useState)(null),[Y,$]=(0,r.useState)(0);(0,r.useEffect)(()=>{fetch("/pipeline-visualization.svg").then(e=>e.text()).then(e=>X(e)).catch(e=>console.error("Failed to load SVG:",e))},[]);let ee={START_ROUND:"0-start",GATHER_CONTEXT:"1-context",PERFORM_DMAS:"2-perform-dma",PERFORM_ASPDMA:"3-perform-aspdma",CONSCIENCE_EXECUTION:"4-conscience",FINALIZE_ACTION:"5-option-handler",PERFORM_ACTION:"6-handler",ACTION_COMPLETE:"6-handler-execution",ROUND_COMPLETE:"8-round-complete",RECURSIVE_ASPDMA:"3-perform-aspdma",RECURSIVE_CONSCIENCE:"4-conscience"},et=(0,r.useCallback)((e,t,s)=>{E(a=>{let r=new Map(a),n=r.get(t);if(!n){let e=D[T.current%D.length];T.current++,n={color:e,thoughts:new Map,completed:!1},r.set(t,n),console.log("\uD83C\uDFA8 FLOW: New task ".concat(t," assigned color ").concat(e))}let i=["action_complete","action_result"].includes(s.toLowerCase());return n.thoughts.set(e,{currentStep:s,completed:i}),i&&(n.completed=!0,console.log("\uD83C\uDFA8 FLOW: Task ".concat(t," marked as completed")),A(e=>new Set([...e,t])),M(e=>[...e,{taskId:t,color:n.color,completedAt:new Date}]),setTimeout(()=>{A(e=>{let s=new Set(e);return s.delete(t),s})},2e3)),console.log("\uD83C\uDFA8 FLOW: Updated task ".concat(t,", thought ").concat(e," → ").concat(s)),console.log("\uD83C\uDFA8 FLOW: Total active tasks: ".concat(r.size,", Task colors:"),Array.from(r.values()).map(e=>e.color)),r})},[D]);(0,r.useCallback)(e=>{let t=[];for(console.log("\uD83C\uDFA8 PROGRESS: Generating bars for ".concat(e,", activeTasks:"),S.size),Array.from(S.entries()).forEach(s=>{let[r,n]=s;if(Array.from(n.thoughts.values()).some(t=>{let s=t.currentStep.toLowerCase(),a=e.toLowerCase();return!!(a.includes("snapshot")&&(s.includes("snapshot")||s.includes("gather")||s.includes("dmas"))||a.includes("dma_results")&&(s.includes("aspdma")||s.includes("dma_results"))||a.includes("aspdma_result")&&(s.includes("conscience")||s.includes("aspdma_result"))||a.includes("conscience_result")&&(s.includes("finalize")||s.includes("conscience_result"))||a.includes("action_result")&&(s.includes("action")||s.includes("complete")))})){var i;let s=Array.from(n.thoughts.values()).some(t=>t.currentStep.toLowerCase().includes(e.toLowerCase()));t.push((0,a.jsx)("div",{className:"w-4 h-4 rounded-full transition-all duration-300 ".concat(n.color," ").concat(s?"animate-pulse ring-2 ring-white":"opacity-70"),title:"Task ".concat(null==(i=r.split("-").pop())?void 0:i.substring(0,6)," - ").concat(e)},"".concat(r,"-").concat(e)))}});t.length<4;)t.push((0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-gray-200"},"empty-".concat(t.length)));return console.log("\uD83C\uDFA8 PROGRESS: Generated ".concat(t.length," bars for ").concat(e)),t.slice(0,8)},[S]);let es=(0,r.useCallback)(e=>{let t=Date.now();if(e===J&&t-Y<1e3)return void console.log("\uD83D\uDEAB Skipping duplicate step: ".concat(e," (too recent)"));let s=ee[e];s&&(console.log("\uD83C\uDFA8 Animating step: ".concat(e," -> SVG ID: ").concat(s)),Z(e),$(t),setTimeout(()=>{let t=document.getElementById(s);console.log("\uD83D\uDD0D Element ".concat(s," found:"),!!t),t&&console.log("\uD83D\uDCCD Element type: ".concat(t.tagName,", classes: ").concat(t.className));let a=[e];("ACTION_COMPLETE"===e||"ROUND_COMPLETE"===e)&&a.push("ACTION_COMPLETE"===e?"ROUND_COMPLETE":"ACTION_COMPLETE"),a.forEach(e=>{let t=ee[e];t&&(Q(e=>new Set([...e,t])),setTimeout(()=>{Q(e=>{let s=new Set(e);return s.delete(t),s})},2e3))})},100))},[ee,J,Y]);(0,r.useEffect)(()=>{t&&(console.log("Current step:",t),es(t))},[t,es]);let ea="paused"===f,er="running"===f;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"px-4 py-5 sm:px-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Runtime Control"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Step-by-step debugging and visualization of CIRIS ethical reasoning pipeline"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg px-4 py-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),(0,a.jsx)("div",{className:"w-3 h-3 bg-purple-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Task Flow Visualization Active"})]}),(0,a.jsxs)("div",{className:"text-xs text-blue-600 mt-1",children:["Active Tasks: ",S.size," | Stream: ",y?"\uD83D\uDFE2":"\uD83D\uDD34"]})]})]})})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Pipeline Control"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.md,{status:ea?"yellow":er?"green":"gray",className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:(null==f?void 0:f.toUpperCase())||"UNKNOWN"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[!e("ADMIN")&&(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Admin Access Required"}),(0,a.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"Runtime control operations require Administrator privileges. You can view the current state but cannot modify runtime execution."})]})]})}),(0,a.jsx)("button",{onClick:()=>H.mutate(),disabled:ea||H.isPending||!e("ADMIN"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-yellow-600 hover:bg-yellow-700 disabled:opacity-50 disabled:cursor-not-allowed",children:H.isPending?"Pausing...":"Pause"}),(0,a.jsx)("button",{onClick:()=>G.mutate(),disabled:!ea||G.isPending||!e("ADMIN"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:G.isPending?"Resuming...":"Resume"}),(0,a.jsx)("button",{onClick:()=>B.mutate(),disabled:!ea||B.isPending||!e("ADMIN"),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:B.isPending?"Stepping...":"Single Step"}),!e("ADMIN")&&(0,a.jsx)("span",{className:"text-sm text-gray-500 ml-4",children:"Controls disabled - Admin role required"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:p-6 rounded-lg",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Cognitive State"}),(0,a.jsx)("dd",{className:"mt-1 text-xl font-semibold text-gray-900",children:(null==F?void 0:F.cognitive_state)||"WORK"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:p-6 rounded-lg",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Queue Depth"}),(0,a.jsx)("dd",{className:"mt-1 text-xl font-semibold text-gray-900",children:(null==F?void 0:F.queue_depth)||0})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:p-6 rounded-lg",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Most Recent Event"}),(0,a.jsx)("dd",{className:"mt-1 text-lg font-semibold text-blue-600",children:t?W(t):"None"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:p-6 rounded-lg",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Step Time"}),(0,a.jsx)("dd",{className:"mt-1 text-xl font-semibold text-green-600",children:(null==g?void 0:g.processing_time_ms)?"".concat(g.processing_time_ms,"ms"):"N/A"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:p-6 rounded-lg",children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Tokens Used"}),(0,a.jsx)("dd",{className:"mt-1 text-xl font-semibold text-purple-600",children:(null==g?void 0:g.tokens_used)?g.tokens_used.toLocaleString():"N/A"})]})]})]})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Real-time Stream Status"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.md,{status:y?"green":"red",className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:y?"CONNECTED":"DISCONNECTED"})]})]}),w&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:(0,a.jsx)("p",{className:"text-sm text-red-800",children:w})}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsxs)("p",{children:["Updates received: ",_.length]}),(0,a.jsx)("p",{children:"Endpoint: /v1/system/runtime/reasoning-stream"})]})]})}),(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"H3ERE Pipeline (11 Step Points)"}),(0,a.jsx)("div",{className:"w-full overflow-x-auto",children:(0,a.jsxs)("div",{className:"min-w-[1200px] bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n                ".concat(Array.from(q).map(e=>"\n                  #".concat(e,", g#").concat(e," {\n                    stroke: #ff0000 !important;\n                    fill: #ff0000 !important;\n                    stroke-width: 5 !important;\n                    opacity: 1 !important;\n                    animation: simplePulse 1s ease-in-out infinite !important;\n                  }\n                  #").concat(e," *, g#").concat(e," * {\n                    stroke: #ff0000 !important;\n                    fill: #ff0000 !important;\n                    stroke-width: 3 !important;\n                    opacity: 1 !important;\n                  }\n                ")).join(""),"\n                \n                @keyframes simplePulse {\n                  0%, 100% { opacity: 1; }\n                  50% { opacity: 0.3; }\n                }\n              ")}}),K?(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:K}}):(0,a.jsx)("div",{className:"flex items-center justify-center h-[150px] text-gray-500",children:"Loading pipeline visualization..."})]})}),(0,a.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"H3ERE Pipeline Step Indicators"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 text-xs",children:Object.values(m).map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-1 rounded ".concat(t===e?"bg-blue-200 text-blue-900 font-semibold":"text-blue-700"),children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(t===e?"bg-blue-600 animate-pulse":"bg-blue-400")}),(0,a.jsx)("span",{children:W(e)}),"RECURSIVE_ASPDMA"===e&&(0,a.jsx)("span",{className:"text-orange-600",children:"(conditional)"}),"RECURSIVE_CONSCIENCE"===e&&(0,a.jsx)("span",{className:"text-orange-600",children:"(conditional)"})]},e))}),(0,a.jsx)("div",{className:"mt-3 text-xs text-blue-600",children:(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Note:"})," Steps 3B & 4B are conditional - only executed when conscience evaluation fails."]})})]})]})}),p&&t&&(0,a.jsx)("div",{className:"bg-white shadow rounded-lg",children:(0,a.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Live Step Details"}),(0,a.jsx)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:W(t)})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Raw Step Data:"}),(0,a.jsx)("pre",{className:"text-sm text-gray-600 overflow-x-auto",children:JSON.stringify(p,null,2)})]}),_.length>0&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900 mb-2",children:["Recent Updates (",_.slice(-5).length," of ",_.length,"):"]}),(0,a.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:_.slice(-5).reverse().map((e,t)=>(0,a.jsxs)("div",{className:"text-xs bg-white border rounded p-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600",children:e.step_point?W(e.step_point):"No step point"}),(0,a.jsx)("span",{className:"text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()})]}),e.processing_time_ms&&(0,a.jsxs)("span",{className:"text-green-600",children:["⏱️ ",e.processing_time_ms,"ms"]}),e.tokens_used&&(0,a.jsxs)("span",{className:"text-purple-600 ml-2",children:["\uD83E\uDE99 ",e.tokens_used," tokens"]})]},t))})]})]})}),k.size>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Task & Thought Pipeline Tracking"}),(0,a.jsx)("div",{className:"space-y-4",children:Array.from(k.entries()).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg",children:[(0,a.jsx)("div",{className:"px-4 py-3 bg-gray-50 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>{L(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-gray-400",children:P.has(t)?"▼":"▶"}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:["Task: ","unknown"===t?"System Task":t.substring(0,12)+"..."]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["(",s.thoughts.size," thought",1!==s.thoughts.size?"s":"",")"]})]}),(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["Updated: ",new Date(s.last_updated).toLocaleTimeString()]})]})}),P.has(t)&&(0,a.jsx)("div",{className:"border-t border-gray-200",children:Array.from(s.thoughts.entries()).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"border-b border-gray-100 last:border-b-0",children:[(0,a.jsx)("div",{className:"px-6 py-3 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>{z(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:U.has(t)?"▼":"▶"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[s.thought_id.substring(0,20),"..."]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("completed"===s.status?"bg-green-100 text-green-800":"processing"===s.status?"bg-blue-100 text-blue-800":"failed"===s.status?"bg-red-100 text-red-800":"blocked"===s.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:s.status}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Type: ",s.thought_type]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Steps: ",s.steps.size,"/11"]})]}),s.total_processing_time_ms&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Total: ",s.total_processing_time_ms.toFixed(1),"ms"]})]})}),U.has(t)&&s.steps.size>0&&(0,a.jsx)("div",{className:"px-8 py-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"Pipeline Steps (in order):"}),Array.from(s.steps.entries()).sort((e,t)=>{let[s]=e,[a]=t,r=Object.values(m);return r.indexOf(s)-r.indexOf(a)}).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex items-start space-x-3 text-xs",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-32",children:(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded text-xs font-medium ".concat("completed"===s.status?"bg-green-100 text-green-800":"processing"===s.status?"bg-blue-100 text-blue-800":"failed"===s.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:s.step_name})}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:["Category: ",s.step_category]}),s.processing_time_ms&&(0,a.jsxs)("span",{className:"text-gray-500",children:["• ",s.processing_time_ms.toFixed(1),"ms"]}),void 0!==s.progress_percentage&&(0,a.jsxs)("span",{className:"text-gray-500",children:["• ",s.progress_percentage.toFixed(1),"%"]}),void 0!==s.stream_sequence&&(0,a.jsxs)("span",{className:"text-gray-400",children:["• Seq: ",s.stream_sequence]}),(0,a.jsxs)("span",{className:"text-gray-400",children:["• ",new Date(s.timestamp).toLocaleTimeString()]})]}),s.content_preview&&(0,a.jsxs)("div",{className:"text-gray-600 italic",children:['"',s.content_preview,'"']}),s.step_result&&(0,a.jsxs)("details",{className:"text-xs",children:[(0,a.jsx)("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-800",children:"Step Result Data"}),(0,a.jsx)("pre",{className:"mt-1 p-2 bg-gray-100 rounded text-xs whitespace-pre-wrap break-words max-w-full overflow-hidden",children:JSON.stringify(s.step_result,null,2)})]}),s.transparency_data&&(0,a.jsxs)("details",{className:"text-xs",children:[(0,a.jsx)("summary",{className:"cursor-pointer text-purple-600 hover:text-purple-800",children:"Transparency Data"}),(0,a.jsx)("pre",{className:"mt-1 p-2 bg-purple-50 rounded text-xs whitespace-pre-wrap break-words max-w-full overflow-hidden",children:JSON.stringify(s.transparency_data,null,2)})]}),s.raw_server_data&&(0,a.jsxs)("details",{className:"text-xs",children:[(0,a.jsx)("summary",{className:"cursor-pointer text-orange-600 hover:text-orange-800",children:"Raw Server Data"}),(0,a.jsx)("pre",{className:"mt-1 p-2 bg-orange-50 rounded text-xs whitespace-pre-wrap break-words max-w-full overflow-hidden",children:JSON.stringify(s.raw_server_data,null,2)})]}),s.error&&(0,a.jsxs)("div",{className:"text-red-600",children:["Error: ",s.error]})]})]},t)})]})})]},t)})})]},t)})})]}),(0,a.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"How to use Runtime Control"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-blue-700",children:(0,a.jsxs)("ol",{className:"list-decimal list-inside space-y-1",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Real-time Stream"}),": Connects to /v1/system/runtime/reasoning-stream for live updates"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"H3ERE Pipeline"}),": 11 step points (0-10) with conditional recursive steps"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Pause/Resume"}),": Control processing while maintaining stream connection"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Single Step"}),": Execute one pipeline step (when paused)"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Live Visualization"}),": See reasoning process in real-time during normal operation"]})]})})]})]})})]})}},9484:(e,t,s)=>{"use strict";s.d(t,{A:()=>u,O:()=>d});var a=s(4568),r=s(7620),n=s(2942),i=s(3237),o=s(704),l=s(3120);let c=(0,r.createContext)(void 0);function d(e){let{children:t}=e,[s,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[p,h]=(0,r.useState)(null),g=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=window.location.pathname;"/login"===e||e.startsWith("/manager")?m(!1):x();let t=localStorage.getItem("manager_token");t&&h(t)},[]);let x=async()=>{try{if(o.AQ.isAuthenticated()){let e=await o.AQ.auth.getMe();d(e)}}catch(e){console.error("Auth check failed:",e)}finally{m(!1)}},f=(0,r.useCallback)(async(e,t)=>{try{let s=localStorage.getItem("selectedAgentId");if(!s)throw Error("No agent selected");l._.configure(s);let a=await o.AQ.login(e,t),r=o.AQ.auth.getAccessToken();r&&l._.configure(s,r),d(a),i.Ay.success("Welcome, ".concat(a.username||a.user_id,"!")),g.push("/")}catch(e){throw i.Ay.error(e.message||"Login failed"),e}},[g]),v=(0,r.useCallback)(async()=>{try{await o.AQ.logout(),d(null),i.Ay.success("Logged out successfully"),g.push("/login")}catch(e){console.error("Logout failed:",e),i.Ay.error("Logout failed")}},[g]),_=(0,r.useCallback)(e=>!!s&&(s.permissions.includes(e)||"SYSTEM_ADMIN"===s.role),[s]),N=(0,r.useCallback)(e=>{if(!s)return!1;let t=["OBSERVER","ADMIN","AUTHORITY","SYSTEM_ADMIN"];return t.indexOf(s.role)>=t.indexOf(e)},[s]),y=(0,r.useCallback)(e=>{o.AQ.setConfig({authToken:e})},[]),C=(0,r.useCallback)(()=>!!p,[p]);return(0,a.jsx)(c.Provider,{value:{user:s,loading:u,login:f,logout:v,hasPermission:_,hasRole:N,setUser:d,setToken:y,managerToken:p,setManagerToken:h,isManagerAuthenticated:C},children:t})}function u(){let e=(0,r.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4534,8903,3297,704,587,8315,7358],()=>t(1739)),_N_E=e.O()}]);
